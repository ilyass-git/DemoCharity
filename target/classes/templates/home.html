<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CharityApp - Faites la différence</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .hero-section {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1532629345422-7515f3d16bb6?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            height: 60vh;
            display: flex;
            align-items: center;
            color: white;
        }
        .category-card {
            transition: transform 0.3s;
        }
        .category-card:hover {
            transform: translateY(-5px);
        }
        .action-card {
            height: 100%;
            transition: transform 0.3s;
        }
        .action-card:hover {
            transform: translateY(-5px);
        }
        .progress {
            height: 25px;
        }
        .organisation-card {
            transition: transform 0.3s;
        }
        .organisation-card:hover {
            transform: translateY(-5px);
        }
        /* Styles pour les boutons de connexion/déconnexion */
        #loginButton {
            display: block;
        }
        #logoutButton {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">CharityApp</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#actions">Actions</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#categories">Catégories</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#organisations">Organisations</a>
                    </li>
                    <li class="nav-item" id="loginButton">
                        <a class="nav-link" href="/login"><span class="btn btn-primary ms-2">Se connecter</span></a>
                    </li>
                    <li class="nav-item" id="logoutButton">
                        <a class="nav-link" href="#" onclick="handleLogout()"><span class="btn btn-danger ms-2">Se déconnecter</span></a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container text-center">
            <h1 class="display-4">Faites la différence aujourd'hui</h1>
            <p class="lead">Rejoignez notre communauté et participez à des actions caritatives qui changent des vies</p>
            <a href="#actions" class="btn btn-primary btn-lg">Découvrir les actions</a>
        </div>
    </section>

    <!-- Actions Section -->
    <section id="actions" class="py-5">
        <div class="container">
            <h2 class="text-center mb-4">Actions en cours</h2>
            <div class="row g-4">
                <div th:if="${actions != null and !actions.empty}" class="col-md-4" th:each="action : ${actions}">
                    <div class="card action-card">
                        <div class="card-body">
                            <h5 class="card-title" th:text="${action.titre}">Titre de l'action</h5>
                            <p class="card-text" th:text="${action.description}">Description</p>
                            <div class="progress mb-3">
                                <div class="progress-bar" role="progressbar" 
                                     th:style="'width: ' + ${(action.montantActuel / action.objectifCollecte) * 100} + '%'"
                                     th:text="${#numbers.formatDecimal((action.montantActuel / action.objectifCollecte) * 100, 0, 1) + '%'}">
                                </div>
                            </div>
                            <p class="mb-2">
                                <strong>Objectif:</strong> 
                                <span th:text="${#numbers.formatDecimal(action.objectifCollecte, 0, 2) + ' €'}">0 €</span>
                            </p>
                        </div>
                    </div>
                </div>
                <div th:if="${actions == null or actions.empty}" class="col-12 text-center">
                    <p>Aucune action en cours pour le moment.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section id="categories" class="py-5 bg-light">
        <div class="container">
            <h2 class="text-center mb-4">Catégories</h2>
            <div class="row g-4">
                <div th:if="${categories != null and !categories.empty}" class="col-md-3" th:each="categorie : ${categories}">
                    <div class="card category-card">
                        <div class="card-body text-center">
                            <h5 class="card-title" th:text="${categorie.nom}">Nom de la catégorie</h5>
                            <p class="card-text" th:text="${categorie.description}">Description</p>
                        </div>
                    </div>
                </div>
                <div th:if="${categories == null or categories.empty}" class="col-12 text-center">
                    <p>Aucune catégorie disponible pour le moment.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Organisations Section -->
    <section id="organisations" class="py-5">
        <div class="container">
            <h2 class="text-center mb-4">Nos Organisations Partenaires</h2>
            <div class="row g-4">
                <div th:if="${organisations != null and !organisations.empty}" class="col-md-4" th:each="organisation : ${organisations}">
                    <div class="card organisation-card">
                        <div class="card-body">
                            <h5 class="card-title" th:text="${organisation.nom}">Nom de l'organisation</h5>
                            <p class="card-text" th:text="${organisation.mission}">Mission</p>
                            <p class="card-text">
                                <small class="text-muted">
                                    <i class="fas fa-map-marker-alt"></i> 
                                    <span th:text="${organisation.adresse + ', ' + organisation.ville}">Adresse</span>
                                </small>
                            </p>
                        </div>
                    </div>
                </div>
                <div th:if="${organisations == null or organisations.empty}" class="col-12 text-center">
                    <p>Aucune organisation partenaire pour le moment.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>CharityApp</h5>
                    <p>Faites la différence, un don à la fois.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p>Contact: contact@charityapp.com</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Authentication Script -->
    <script>
        // Vérifier immédiatement si l'utilisateur est connecté
        (function() {
            const token = localStorage.getItem('token');
            const loginButton = document.getElementById('loginButton');
            const logoutButton = document.getElementById('logoutButton');
            
            if (token) {
                // L'utilisateur est connecté
                loginButton.style.display = 'none';
                logoutButton.style.display = 'block';
            } else {
                // L'utilisateur n'est pas connecté
                loginButton.style.display = 'block';
                logoutButton.style.display = 'none';
            }
        })();
        
        // Vérifier à nouveau après le chargement complet du DOM
        document.addEventListener('DOMContentLoaded', function() {
            const token = localStorage.getItem('token');
            const loginButton = document.getElementById('loginButton');
            const logoutButton = document.getElementById('logoutButton');
            
            if (token) {
                // L'utilisateur est connecté
                loginButton.style.display = 'none';
                logoutButton.style.display = 'block';
            } else {
                // L'utilisateur n'est pas connecté
                loginButton.style.display = 'block';
                logoutButton.style.display = 'none';
            }
        });
        
        // Gérer la déconnexion
        function handleLogout() {
            // Supprimer le token
            localStorage.removeItem('token');
            
            // Mettre à jour l'interface
            const loginButton = document.getElementById('loginButton');
            const logoutButton = document.getElementById('logoutButton');
            loginButton.style.display = 'block';
            logoutButton.style.display = 'none';
            
            // Afficher un message de confirmation
            const messageDiv = document.createElement('div');
            messageDiv.className = 'alert alert-success alert-dismissible fade show';
            messageDiv.setAttribute('role', 'alert');
            messageDiv.innerHTML = `
                <strong>Déconnexion réussie!</strong> Vous avez été déconnecté avec succès.
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            `;
            
            // Insérer le message après la section hero
            const heroSection = document.querySelector('.hero-section');
            heroSection.parentNode.insertBefore(messageDiv, heroSection.nextSibling);
            
            // Supprimer le message après 5 secondes
            setTimeout(() => {
                messageDiv.classList.remove('show');
                setTimeout(() => messageDiv.remove(), 150);
            }, 5000);
        }
    </script>
</body>
</html> 